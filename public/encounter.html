<!DOCTYPE html>
<html lang="en" ng-app="clientApp">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta charset="utf-8">
        <meta name="generator" content="Bootply" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

        <link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.min.css">
        <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
        <script src="bower_components/jquery/dist/jquery.min.js"></script>
        <script src="bower_components/jquery-ui/jquery-ui.min.js"></script>
        <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
        <link href="stylesheet/style.css" rel="stylesheet">

        <script src="bower_components/angular/angular.js"></script>
        <script src="bower_components/angular-animate/angular-animate.js"></script>
        <script src="bower_components/angular-sanitize/angular-sanitize.min.js"></script>
        <script src="bower_components/angular-strap/dist/angular-strap.min.js"></script>
        <script src="bower_components/angular-strap/dist/angular-strap.tpl.min.js"></script>
        <!--script src="bower_components/angular-ui-sortable/sortable.min.js"></script-->
        <link rel="stylesheet" href="bower_components/angular-motion/dist/angular-motion.min.css">

        <script src="/socket.io/socket.io.js"></script>
        <script src="javascript/app/encounterApp.js"></script>
        <script src="javascript/profileService.js"></script>
        <script src="javascript/control/headerController.js"></script>
        <script src="javascript/socketFactory.js"></script>
        <script src="javascript/control/encounterController.js"></script>
        <script src="javascript/control/encounterAddPlayerController.js"></script>

        <title>Dungeon Map</title>
	</head>
	<body>
		<nav class="navbar navbar-static navbar-inverse">
            <div class="container">
                <div class="nav-collapse collase">
                    <ul class="nav navbar-nav navbar-left">
                        <li><a href="home.html">Home</a></li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Resources <i class="fa fa-chevron-down"></i></a>
                            <ul class="dropdown-menu">
                                <li><a href="pdf/Players Handbook 5E.pdf" target="_blank">Player's Handbook</a></li>
                             </ul>
                        </li>
                    </ul>
                    <ul class="nav navbar-right navbar-nav">
                        <li class="dropdown" ng-controller="headerController">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">{{ name }}  <i class="fa fa-user"></i> <i class="fa fa-chevron-down"></i></a>
                            <ul class="dropdown-menu">
                                <li><a href="login.html">Logout</a></li>
                                <li><a href="#">Profile</a></li>
                                <li class="divider"></li>
                                <li><a href="#">About</a></li>
                             </ul>
                        </li>
                    </ul>
                </div>
            </div>
		</nav><!-- /.navbar -->

<!-- Begin Body -->
		<div class="container" ng-controller="encounterController">
			<div class="row">
				<div class="col col-sm-2">
					<hr>
					<div class="well well-sm">
						<div class="list-group" style="margin-bottom: 0px">
							<a href="#" class="list-group-item" data-template-url="modal/encounterAddPlayerModal.html" data-placement="center" bs-modal="modal">Add Player</a>
							<a href="#" ng-show="isHost()" class="list-group-item" data-template-url="modal/encounterAddNPCModal.html" bs-modal="modal">Add NPC</a>
							<a href="#" ng-show="isHost()" class="list-group-item" data-template-url="modal/endEncounterModal.html" title="End Encounter?" bs-modal="modal">End Encounter</a>
						</div>
					</div>
				</div>
				<div class="col col-md-7">
					<h1>{{ encounter.title }}<span style="color: red; float: right;">{{ status }}</span></h1>
					<div class ="container-fluid">
						<div class="row">
							<div class="col col-md-12 panel-group" data-allow-multiple="true" role="tablist" aria-multiselectable="true" bs-collapse>
								<div class="panel panel-default" ng-repeat="player in players track by $index">
									<div class="panel-heading" role="tab">
										<h4 class="panel-title">
											<a bs-collapse-toggle data-toggle="collapse">{{ player.name }} </a>
											<span style="float: right;">
												<i class="fa fa-heart"></i>
												<span ng-if="!isHost() && isNPC($index)">???
													<span ng-if="(player.hitPoints - player.maxHitPoints) < 0" style="color: red">  {{ player.hitPoints - player.maxHitPoints }}</span>
													<span ng-if="(player.hitPoints - player.maxHitPoints) > 0" style="color: green">  +{{ player.hitPoints - player.maxHitPoints }}</span>
													<span ng-if="(player.hitPoints - player.maxHitPoints) === 0"></span>
												</span>
												<a href="#" ng-show="isHost()" ng-click="removePlayer($index)" style="color: black;"><i class="fa fa-close"></i></a>
												<a href="#" ng-show="isHost() && isNPC($index) && isVisible($index)" ng-click="toggleVisible($index)"> <i class="fa fa-eye"></i></a>
												<a href="#" ng-show="isHost() && isNPC($index) && !isVisible($index)" ng-click="toggleVisible($index)"> <i class="fa fa-eye-slash"></i></a>
												<strong style="float: right; color: red;">{{ player.status }} </strong>
											</span>
										</h4>
									</div>
									<div class="panel-collapse" role="tabpanel" bs-collapse-target>
										<div class="panel-body">
											Data
										</div>
									</div>
									<!--div class="panel-collapse" role="tabpanel" bs-collapse-target>
										<div class="panel-body" ng-show="!isNPC($index) || isHost()" style="padding-top: 10px; padding-bottom: 0px; padding-right: 5px">
											<ul class="fa-ul">
												<li>
													<i class="fa-li fa fa-heart"></i>
													<span ng-if="player.hitPoints < 1" style="color: red">{{ player.hitPoints }}</span>
													<span ng-if="player.hitPoints > player.maxHitPoints" style="color: green">{{ player.hitPoints }}</span>
													<span ng-if="player.hitPoints <= player.maxHitPoints && player.hitPoints > 0">{{ player.hitPoints }}</span>
													 / {{ player.maxHitPoints }}
													<span style="float: right">
													<a href="#" ng-show="isHost()" ng-click="setPlayer($index); setMultiplier(1)" data-placement="bottom" data-template-url="modal/playerHPPopover.html" data-auto-close="1" bs-popover><i class="fa fa-plus" style="color: green;"></i></a>
													<a href="#" ng-show="isHost()" ng-click="setPlayer($index); setMultiplier(-1)" data-placement="bottom" data-template-url="modal/playerHPPopover.html" data-auto-close="1" bs-popover><i class="fa fa-minus" style="color: red;"></i></a>
													</span>
												</li>
												<li><i class="fa-li fa fa-shield"></i>{{ player.armorClass }}</li>
											</ul>
										</div>
									</div>
									<div class="panel-body" ng-show="isNPC($index) && !isHost()" style="padding-top: 10px; padding-bottom: 0px; padding-right: 5px">
										<ul class="fa-ul">
											<li>
												<i class="fa-li fa fa-heart"></i>???
												<span ng-if="(player.hitPoints - player.maxHitPoints) < 0" style="color: red">  {{ player.hitPoints - player.maxHitPoints }}</span>
												<span ng-if="(player.hitPoints - player.maxHitPoints) > 0" style="color: green">  +{{ player.hitPoints - player.maxHitPoints }}</span>
												<span ng-if="(player.hitPoints - player.maxHitPoints) === 0"></span>
												<span style="float: right">
												<a href="#" ng-show="isHost()" ng-click="setPlayer($index); setMultiplier(1)" data-placement="bottom" data-template-url="modal/playerHPPopover.html" data-auto-close="1" bs-popover><i class="fa fa-plus" style="color: green;"></i></a>
												<a href="#" ng-show="isHost()" ng-click="setPlayer($index); setMultiplier(-1)" data-placement="bottom" data-template-url="modal/playerHPPopover.html" data-auto-close="1" bs-popover><i class="fa fa-minus" style="color: red;"></i></a>
												</span>
											</li>
											<li><i class="fa-li fa fa-shield"></i>???</li>
										</ul>
									</div-->

								</div>
							</div>
						</div>
					</div>
					<!--div class="panel" ng-repeat="encounter in encounters">
						<h2>{{ encounter.title }}</h2>
						<h6> Hosted by: {{ encounter.host }}</h6>
						<p>{{ encounter.description }}</p>
						<button class="btn btn-default"><a href="encounter.html?{{ encounter._id }}">Join Encounter</a></button>

						<hr>
					</div-->
				</div>
				<div class="col col-sm-3">
				<br>
				<br>
				<br>
					<ul class="nav nav-stacked">
						<!--li><h4>Initiatives  <i class="fa fa-bolt"></i></h4></li-->
						<li>
							<div class="initiative box">
								<ul ng-model="players" class="list-group">
									<li class="list-group-item active"><h4>Initiatives <i class="fa fa-bolt"></i></h4></li>
									<li ng-repeat="player in players | orderBy:'-initiative'" class="list-group-item" ng-hide="!isHost() && !player.visible">
									<span ng-if="player.hitPoints < 1" style="color:red"><strike>{{ player.name }}</strike></span>
									<span ng-if="player.hitPoints > 0">{{ player.name }}</span>
									<span class="badge"><i class="fa fa-bolt"></i> {{ player.initiative }}</span></li>
								</ul>
							</div>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</body>
</html>
